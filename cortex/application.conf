####################################################################
#  Unified Open-Source SOC Platform
#  Author : Boni Yeamin
#  Open Source V:1.0
#  File   : cortex/application.conf
#  Purpose: Cortex analyzer/responder engine configuration.
#           Connects to Elasticsearch, manages job processing,
#           and provides the API for TheHive enrichment requests.
####################################################################
#
# Step 1: Cortex starts and connects to Elasticsearch for storage
# Step 2: Analyzers are loaded (VirusTotal, AbuseIPDB, etc.)
# Step 3: TheHive sends observables to Cortex for analysis
# Step 4: Results flow back to TheHive case automatically
#

# ── Cortex 3 Application Configuration ────────────────────
# SOC Platform Integration

# =============================================================
# Play Framework Settings
# =============================================================
play.http.secret.key = ${?CORTEX_SECRET}
play.server.http.port = 9001

# =============================================================
# Authentication
# =============================================================
auth {
  provider = [local]
  ad {
    enabled = false
  }
  ldap {
    enabled = false
  }
}

# =============================================================
# Analyzers & Responders
# =============================================================
analyzer {
  # Path where analyzer packages are installed
  urls = [
    "https://download.thehive-project.org/analyzers.json"
  ]
  fork-join-executor {
    parallelism-min    = 2
    parallelism-factor = 2.0
    parallelism-max    = 4
  }
}

responder {
  urls = [
    "https://download.thehive-project.org/responders.json"
  ]
  fork-join-executor {
    parallelism-min    = 2
    parallelism-factor = 2.0
    parallelism-max    = 4
  }
}

# =============================================================
# Job Configuration
# =============================================================
job {
  runner = [docker, process, kubernetes]
  docker {
    autoUpdate = true
  }
}

# =============================================================
# Cache
# =============================================================
cache {
  job = 10 minutes
}

# =============================================================
# Elasticsearch (Indexing)
# =============================================================
search {
  host = ["wazuh.indexer:9200"]
  index = cortex
}
