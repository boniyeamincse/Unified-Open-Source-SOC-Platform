####################################################################
#  SOAR Playbook: 17 â€” Known CVE Exploitation
####################################################################
name: "Known CVE Exploitation"
id: "PB-017"
version: "1.0"
author: "Boni Yeamin"
severity: P1
mitre:
  tactics: ["Initial Access"]
  techniques: ["T1190"]

trigger:
  source: "suricata"
  conditions:
    - rule_group: "exploit"

steps:
  - id: 1
    action: "identify_cve"
  - id: 2
    action: "check_patch_status"
  - id: 3
    action: "isolate_if_unpatched"
    auto_execute: true
    condition: "step_2.result.patched == false"
  - id: 4
    action: "emergency_patch"
  - id: 5
    action: "create_case"
    target: "thehive"

containment:
  auto_contain: true
  actions: ["isolate_host", "emergency_patch"]
